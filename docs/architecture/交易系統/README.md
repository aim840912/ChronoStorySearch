# Discord 登入物品意向登記系統 - 架構設計文件

> **專案需求**：Discord 認證、中型規模（1200-1600 MAU）、純資訊媒合、免費額度
>
> **最後更新**：2025-10-26 | **版本**：v4.0（Discord 完整版）

---

## 📖 閱讀指南

本文件已從單一大型檔案拆分為 9 個模組化文件,方便閱讀和維護。

### 🎯 快速導航

#### 核心設計 (必讀)
1. **[系統總覽與架構](./01-系統總覽與架構.md)**
   - 業務目標、核心特性
   - Discord 生態系統整合
   - 整體架構與技術棧選擇

2. **[認證與資料庫](./02-認證與資料庫.md)**
   - Discord OAuth 2.0 認證流程
   - 資料庫 ER 圖與表結構設計

3. **[API 設計](./03-API設計.md)**
   - API 端點總覽
   - 認證要求與中間件實作

#### Discord 整合
4. **[Discord 整合](./04-Discord整合.md)**
   - Webhook 通知設計
   - Discord Bot 伺服器整合
   - 信譽系統機制

#### 安全與效能
5. **[安全與可靠性](./05-安全與可靠性.md)**
   - OAuth 安全機制
   - Session 管理策略
   - Token 自動刷新與撤銷

6. **[效能分析與成本](./06-效能分析與成本.md)**
   - 實際流量分析
   - Redis 命令數消耗
   - 免費額度評估與升級決策

7. **[Bot 防護與監控](./07-Bot防護與監控.md)**
   - Bot Detection 四階段實作方案
   - 監控與維護策略

#### 實作指南
8. **[實作路線圖](./08-實作路線圖.md)** ⭐ **開始實作前必讀**
   - **情境 A**：從零開始建立系統 (階段 0-5)
   - **情境 B**：優化現有系統 (階段 0-5)
   - 每階段詳細任務清單與時程規劃

9. **[設計決策記錄](./09-設計決策記錄.md)**
   - DDR-001: 選擇 Discord OAuth 作為唯一認證方式
   - DDR-002: 選擇 Modal 模式而非獨立頁面
   - DDR-003: 選擇 LoginModal 而非登入頁面
   - DDR-004: 選擇支援物品交換功能

10. **[物品整合設計](./10-物品整合設計.md)** (NEW)
   - 物品資料來源與快取策略
   - ItemSearchInput 元件設計
   - Cloudflare R2 圖片整合

---

## 🚀 快速開始

### 新專案 (從零開始)

1. **閱讀順序**：
   ```
   01-系統總覽與架構
   → 02-認證與資料庫
   → 03-API設計
   → 08-實作路線圖 (情境 A)
   ```

2. **開始實作**：
   - 前往 [實作路線圖 - 情境 A](./08-實作路線圖.md#情境-a從零開始建立系統)
   - 按照 **階段 0 → 階段 1 → 階段 2** 順序執行

### 現有專案 (已上線優化)

1. **閱讀順序**：
   ```
   06-效能分析與成本 (診斷問題)
   → 07-Bot防護與監控 (了解解決方案)
   → 08-實作路線圖 (情境 B)
   ```

2. **開始優化**：
   - 前往 [實作路線圖 - 情境 B](./08-實作路線圖.md#情境-b優化現有系統已上線)
   - 依優先級執行緊急修復

---

## 📊 文件結構

```
docs/architecture/交易系統/
├── README.md                      # 📍 您在這裡
├── 01-系統總覽與架構.md            # 業務目標、技術棧、架構圖
├── 02-認證與資料庫.md              # OAuth 流程、資料庫設計
├── 03-API設計.md                  # API 端點、認證中間件
├── 04-Discord整合.md              # Webhook、Bot、信譽系統
├── 05-安全與可靠性.md              # 安全機制、Session 管理
├── 06-效能分析與成本.md            # 流量分析、成本預估
├── 07-Bot防護與監控.md            # Bot Detection、監控
├── 08-實作路線圖.md               # ⭐ 實作指南 (情境 A/B)
├── 09-設計決策記錄.md             # ADR/DDR 決策記錄
└── 10-物品整合設計.md             # 物品搜尋、選擇、顯示
```

---

## 🔍 主題索引

### 按技術主題查找

| 主題 | 文件 | 章節 |
|------|------|------|
| **Discord OAuth 2.0** | [02-認證與資料庫](./02-認證與資料庫.md) | Discord OAuth 2.0 認證 |
| **API 中間件** | [03-API設計](./03-API設計.md) | 認證實作方式 |
| **Webhook 通知** | [04-Discord整合](./04-Discord整合.md) | Discord Webhook 通知 |
| **Discord Bot** | [04-Discord整合](./04-Discord整合.md) | Discord Bot 伺服器整合 |
| **信譽系統** | [04-Discord整合](./04-Discord整合.md) | 信譽系統 |
| **Session 管理** | [05-安全與可靠性](./05-安全與可靠性.md) | Session 管理策略 |
| **Token 刷新** | [05-安全與可靠性](./05-安全與可靠性.md) | Token 自動刷新機制 |
| **成本預估** | [06-效能分析與成本](./06-效能分析與成本.md) | 免費額度評估 |
| **Bot Detection** | [07-Bot防護與監控](./07-Bot防護與監控.md) | Bot Detection 實作方案 |
| **監控策略** | [07-Bot防護與監控](./07-Bot防護與監控.md) | 監控與維護 |

### 按開發階段查找

| 階段 | 文件 | 說明 |
|------|------|------|
| **規劃階段** | [01-系統總覽與架構](./01-系統總覽與架構.md) | 了解系統目標與架構 |
| **架構設計** | [02-認證與資料庫](./02-認證與資料庫.md) | 設計認證流程與資料庫 |
| **API 開發** | [03-API設計](./03-API設計.md) | 實作 API 端點與中間件 |
| **Discord 整合** | [04-Discord整合](./04-Discord整合.md) | 整合 Webhook 與 Bot |
| **安全強化** | [05-安全與可靠性](./05-安全與可靠性.md) | 實作安全機制 |
| **效能優化** | [06-效能分析與成本](./06-效能分析與成本.md) | 分析流量與成本 |
| **防護加固** | [07-Bot防護與監控](./07-Bot防護與監控.md) | 實作 Bot 防護 |
| **實際執行** | [08-實作路線圖](./08-實作路線圖.md) | 按階段執行開發 |

---

## 💡 常見問題

### Q: 我應該從哪裡開始閱讀?

**A**: 取決於您的情況:
- **新專案**: 從 [01-系統總覽與架構](./01-系統總覽與架構.md) 開始,按順序閱讀到 08
- **已有系統需優化**: 直接看 [06-效能分析與成本](./06-效能分析與成本.md) 和 [08-實作路線圖 (情境 B)](./08-實作路線圖.md#情境-b優化現有系統已上線)
- **只想快速上手**: 直接看 [08-實作路線圖](./08-實作路線圖.md)

### Q: 文件太多,有沒有精簡版?

**A**: 核心必讀文件 (3 份):
1. [01-系統總覽與架構](./01-系統總覽與架構.md) - 了解系統設計
2. [02-認證與資料庫](./02-認證與資料庫.md) - 理解核心架構
3. [08-實作路線圖](./08-實作路線圖.md) - 開始實作

### Q: 如何找到特定技術的說明?

**A**: 使用上方的 **主題索引** 表格快速定位。

---

## 📝 文件版本

- **v4.0** (2025-10-26): 拆分為模組化文件
- **v3.0** (2025-10-25): Discord 完整版設計
- **v2.0** (2025-10-20): 加入 Bot Detection 方案
- **v1.0** (2025-10-15): 初始架構設計

---

## 🔗 相關連結

- **原始完整文件**: `docs/architecture/交易系統架構設計.md` (已保留,標記為已拆分)
- **專案 Git Repo**: `/home/aim840912/projects/maplestory`
- **Discord Developer Portal**: https://discord.com/developers/applications

---

**開始閱讀** → [01-系統總覽與架構](./01-系統總覽與架構.md)
